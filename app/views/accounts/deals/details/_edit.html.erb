<%= turbo_frame_tag "form_#{model.class.name.downcase}_#{model.id}" do %>
  <%= form_with(model: model, url: update_path) do |form| %>
    <% if model.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(model.errors.count, "error") %> prohibited this deal from being saved:</h2>

        <ul>
          <% model.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    <div class="bg-light-palette-p5 rounded-md mb-4 pb-6">
      <div class="px-3 flex items-center h-16">
        <p class="flex items-center m-0 mr-auto font-semibold text-lg"><%= model_name %></p>
        <%= form.submit 'Salvar alterações', class: 'text-brand-palette-03', data: { turbo_frame: "form_#{model.class.name.downcase}_#{model.id}" } %>

        <%= link_to :back, class: 'pl-2 text-dark-gray-palette-p3' do %>
          <i data-lucide="x" height="16"></i>
        <% end %>
      </div>
      <div class="p-3">
        <div>
          <% model.class::FORM_FIELDS.each do | f | %>
            <div class="flex items-center pb-3">
              <%= form.label f, class: 'm-0' %>
              <div class="flex-auto rounded-md mx-3 border-t border-light-palette-p3"></div>
              <%= form.text_field f, class: 'w-64 h-10 rounded-md border-light-palette-p3 bg-light-palette-p4' %>
            </div>
          <% end %>
          <%= render 'accounts/deals/details/edit_custom_attributes', form: form, model: model %>
        </div>
      </div>
      <div class="px-3 border-t-2 border-light-palette-p3 py-2 mt-4">
        <div class="flex items-center mt-2">
          <label class="flex-grow m-0 mb-auto">Adicionar campos</label>
          <div class="w-64">
            <% if model.class.name.downcase == 'deal' %>
              <%= turbo_frame_tag "form_custom_attributes_#{model.class.name.downcase}_#{model.id}" do %>
                <%= link_to account_deal_edit_custom_attributes_path(current_user.account, model), class: 'd-flex align-items-center justify-content-center h-10 border-2 bg-light-palette-p4 text-dark-gray-palette-p3 rounded-md border-light-palette-p3 hover:border-brand-palette-06 hover:bg-brand-palette-08 hover:border-2 hover:text-brand-palette-03 hover:duration-100' do %>
                  <i data-lucide="plus" height="18"></i>
                <% end %>
              <% end %>
            <% elsif model.class.name.downcase == 'contact' %>
              <%= turbo_frame_tag "form_custom_attributes_#{model.class.name.downcase}_#{model.id}" do %>
                <%= link_to account_contact_edit_custom_attributes_path(current_user.account, model), class: 'd-flex align-items-center justify-content-center h-10 border-2 bg-light-palette-p4 text-dark-gray-palette-p3 rounded-md border-light-palette-p3 hover:border-brand-palette-06 hover:bg-brand-palette-08 hover:border-2 hover:text-brand-palette-03 hover:duration-100' do %>
                  <i data-lucide="plus" height="18"></i>
                <% end %>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
<% end %>